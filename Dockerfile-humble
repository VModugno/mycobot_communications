FROM ros:humble-ros-base

RUN mkdir -p /home/ubuntu/ros2_ws/src
WORKDIR /home/ubuntu/ros2_ws

RUN apt update && apt install git nano -y

RUN apt update && apt install python3-colcon-common-extensions -y

RUN git clone -b ros2 https://github.com/VModugno/mycobot_communications
RUN rm -rf mycobot_communications/mycobot_msgs
RUN rm -rf mycobot_communications/mycobot_interface

RUN apt install python3-pip -y
RUN pip install pymycobot
RUN apt-get install libgl1 -y # hidden dep of opencv
RUN pip install opencv-python # hidden dep of pymycobot

RUN /bin/bash -c '. /opt/ros/humble/setup.bash; colcon build --symlink-install'